# 批量上架助手使用说明

## 功能概述

批量上架助手是数据中心管理系统的核心功能之一，用于快速批量导入设备和线缆信息，大幅提升数据中心设备上架效率。

## 主要功能

### 1. 批量创建设备

支持通过 Excel/CSV 文件批量导入设备信息。

#### 支持的字段

| 字段名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| 设备名称 | 文本 | 是 | 设备的唯一标识名称 |
| 设备类型 | 枚举 | 是 | SERVER, SWITCH, ROUTER, FIREWALL, STORAGE, PDU, OTHER |
| 型号 | 文本 | 否 | 设备型号 |
| 序列号 | 文本 | 否 | 设备序列号 |
| 机柜ID | UUID | 是 | 所属机柜的ID |
| U位位置 | 数字 | 否 | 1-42之间的整数 |
| U高度 | 数字 | 否 | 设备占用的U位高度 |

#### 使用步骤

1. 点击「批量导入设备」按钮
2. 点击「下载导入模板」获取示例文件
3. 按照模板格式填写设备信息
4. 上传填写好的 Excel 文件
5. 系统自动验证数据合法性
6. 确认无误后点击「导入」按钮

#### 数据验证规则

- 设备名称不能为空
- 设备类型必须是预定义的类型之一
- 机柜ID必须是系统中已存在的机柜
- U位位置必须在1-42范围内
- U高度必须是正整数

### 2. 批量创建面板

从预定义的面板模板快速创建标准设备面板配置。

#### 使用步骤

1. 点击「从模板创建面板」按钮
2. 选择预定义的面板模板
3. 选择目标设备
4. 确认创建

#### 支持的模板类型

- 网络设备标准面板（24口、48口）
- 服务器面板（双网口、管理口）
- 存储设备面板
- PDU电源面板

### 3. 批量导入线缆

通过 Excel/CSV 文件批量导入线缆连接信息。

#### 支持的字段

| 字段名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| 标签 | 文本 | 否 | 线缆标签 |
| 线缆类型 | 枚举 | 是 | CAT5E, CAT6, CAT6A, FIBER_SM, FIBER_MM, DAC, AOC, QSFP, OTHER |
| 长度(米) | 数字 | 否 | 线缆长度，必须为正数 |
| 颜色 | 文本 | 否 | 线缆颜色 |
| 备注 | 文本 | 否 | 备注信息 |
| 端口A ID | UUID | 是 | 本端端口ID |
| 端口B ID | UUID | 是 | 对端端口ID |

#### 使用步骤

1. 点击「批量导入线缆」按钮
2. 下载导入模板
3. 填写线缆连接信息（需要先获取端口ID）
4. 上传文件并确认导入

## 导入前准备

在使用批量上架功能前，请确保：

1. 已创建数据中心
2. 已创建机房
3. 已创建机柜
4. 已了解机柜的UUID（可从机柜列表页面获取）

## 获取资源ID的方法

### 获取机柜ID

1. 访问「机柜管理」页面
2. 在机柜列表中找到目标机柜
3. 点击机柜详情，URL中包含机柜ID
4. 或通过浏览器开发者工具查看API响应

### 获取端口ID

1. 访问「端口管理」页面
2. 在端口列表中查看端口详情
3. 端口ID显示在详情页面中

## 数据导入结果

### 成功导入

- 显示成功导入的记录数
- 自动刷新设备列表

### 部分失败

- 显示成功和失败的统计信息
- 列出失败的行号和错误原因
- 成功的记录已保存，失败的需要修正后重新导入

### 完全失败

- 显示失败原因
- 检查文件格式和数据合法性

## 注意事项

1. Excel文件格式必须正确，列名必须与模板一致
2. 机柜ID、端口ID等必须是系统中已存在的资源
3. 批量导入会逐条创建记录，失败的记录不影响成功的记录
4. 建议先小批量测试，确认无误后再大批量导入
5. 导入前建议备份数据

## API接口

### 批量创建设备

```
POST /api/v1/devices/bulk-create
Content-Type: application/json

{
  "devices": [
    {
      "name": "SV-001",
      "type": "SERVER",
      "model": "Dell PowerEdge R740",
      "serialNo": "SN123456",
      "cabinetId": "uuid-here",
      "uPosition": 10,
      "uHeight": 2
    }
  ]
}
```

### 响应格式

```json
{
  "success": true,
  "message": "成功创建 2 个设备",
  "data": {
    "success": [...],
    "failed": [
      {
        "index": 3,
        "data": {...},
        "error": "错误信息"
      }
    ]
  }
}
```

## 常见问题

### Q: 为什么导入失败显示"机柜ID不存在"？

A: 请确保填写的机柜ID是系统中已经创建的机柜UUID，可以从机柜管理页面获取。

### Q: 可以导入多少条记录？

A: 理论上没有限制，但建议单次导入不超过1000条记录，以确保性能和稳定性。

### Q: 导入失败后如何处理？

A: 成功的记录已经保存，只需要修正失败的记录重新导入即可。

### Q: 支持哪些文件格式？

A: 支持 .xlsx, .xls 和 .csv 格式的文件。

## 更新日志

- v0.1.0 (2025-11-05): 初始版本，支持设备批量导入和面板模板创建
- 线缆批量导入功能开发中，敬请期待
